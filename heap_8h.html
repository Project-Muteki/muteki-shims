<!-- HTML header for doxygen 1.9.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>muteki-shims: include/osdep/heap.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<!--Doxygen Awesome Plugins-->
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
DoxygenAwesomeTabs.init()
</script>
<!--/Doxygen Awesome Plugins-->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">muteki-shims
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('heap_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">heap.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Heap memory management function hooks.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="common_8h_source.html">muteki/common.h</a>&gt;</code><br />
</div>
<p><a href="heap_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a10eae7c9542b5e78ea56fd3b2418965c" id="r_a10eae7c9542b5e78ea56fd3b2418965c"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heap_8h.html#a10eae7c9542b5e78ea56fd3b2418965c">osdep_heap_alloc</a> (size_t size)</td></tr>
<tr class="memdesc:a10eae7c9542b5e78ea56fd3b2418965c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate and format mchx memchunk.  <br /></td></tr>
<tr class="separator:a10eae7c9542b5e78ea56fd3b2418965c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fead3f93a4297a4d2fd8a01dbd7f43d" id="r_a3fead3f93a4297a4d2fd8a01dbd7f43d"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heap_8h.html#a3fead3f93a4297a4d2fd8a01dbd7f43d">osdep_heap_get_alloc_size</a> (const void *ptr)</td></tr>
<tr class="memdesc:a3fead3f93a4297a4d2fd8a01dbd7f43d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get usable size of an allocated mchx memchunk.  <br /></td></tr>
<tr class="separator:a3fead3f93a4297a4d2fd8a01dbd7f43d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdfa0d5cdfdc2b493b1ecef314a9d610" id="r_acdfa0d5cdfdc2b493b1ecef314a9d610"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heap_8h.html#acdfa0d5cdfdc2b493b1ecef314a9d610">osdep_heap_free</a> (void *ptr)</td></tr>
<tr class="memdesc:acdfa0d5cdfdc2b493b1ecef314a9d610"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free a mchx memchunk.  <br /></td></tr>
<tr class="separator:acdfa0d5cdfdc2b493b1ecef314a9d610"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e99ff083e5e3843d4b3c3d6bb5004bc" id="r_a2e99ff083e5e3843d4b3c3d6bb5004bc"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heap_8h.html#a2e99ff083e5e3843d4b3c3d6bb5004bc">osdep_heap_trace_start</a> (void)</td></tr>
<tr class="memdesc:a2e99ff083e5e3843d4b3c3d6bb5004bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start the heap tracer.  <br /></td></tr>
<tr class="separator:a2e99ff083e5e3843d4b3c3d6bb5004bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd0b9d91ab88ee3f1a10495d2884c3b1" id="r_abd0b9d91ab88ee3f1a10495d2884c3b1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heap_8h.html#abd0b9d91ab88ee3f1a10495d2884c3b1">osdep_heap_trace_stop</a> (void)</td></tr>
<tr class="memdesc:abd0b9d91ab88ee3f1a10495d2884c3b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop the heap tracer.  <br /></td></tr>
<tr class="separator:abd0b9d91ab88ee3f1a10495d2884c3b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Heap memory management function hooks. </p>
<p>Since Besta RTOS does not have virtual memory support, sbrk()-based heap management in newlib will not work great. Spoofing a heap space with a huge malloc() on the OS heap wastes memory and can potentially cause the OS to become unstable. Therefore the solution here is to simply redirect basic heap management functions (i.e. malloc(), calloc(), realloc() and free()) to their Besta RTOS native counterpart so we don't need a custom newlib. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a10eae7c9542b5e78ea56fd3b2418965c" name="a10eae7c9542b5e78ea56fd3b2418965c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10eae7c9542b5e78ea56fd3b2418965c">&#9670;&#160;</a></span>osdep_heap_alloc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void * osdep_heap_alloc </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allocate and format mchx memchunk. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>Size of the memory to allocate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to allocated memory, or NULL if allocation fails. </dd></dl>

</div>
</div>
<a id="acdfa0d5cdfdc2b493b1ecef314a9d610" name="acdfa0d5cdfdc2b493b1ecef314a9d610"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdfa0d5cdfdc2b493b1ecef314a9d610">&#9670;&#160;</a></span>osdep_heap_free()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void osdep_heap_free </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Free a mchx memchunk. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ptr</td><td>Pointer to previously allocated memory.</td></tr>
  </table>
  </dd>
</dl>
<p><dl class="section user"><dt>Returns</dt><dd>None. </dd></dl>
 </p>

</div>
</div>
<a id="a3fead3f93a4297a4d2fd8a01dbd7f43d" name="a3fead3f93a4297a4d2fd8a01dbd7f43d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fead3f93a4297a4d2fd8a01dbd7f43d">&#9670;&#160;</a></span>osdep_heap_get_alloc_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t osdep_heap_get_alloc_size </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get usable size of an allocated mchx memchunk. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ptr</td><td>Memory allocated by <a class="el" href="heap_8h.html#a10eae7c9542b5e78ea56fd3b2418965c" title="Allocate and format mchx memchunk.">osdep_heap_alloc()</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Size of usable memory. </dd></dl>

</div>
</div>
<a id="a2e99ff083e5e3843d4b3c3d6bb5004bc" name="a2e99ff083e5e3843d4b3c3d6bb5004bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e99ff083e5e3843d4b3c3d6bb5004bc">&#9670;&#160;</a></span>osdep_heap_trace_start()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool osdep_heap_trace_start </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Start the heap tracer. </p>
<p><dl class="section user"><dt>Parameters</dt><dd>None. </dd></dl>
 </p><dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>The operation was completed successfully.  </td></tr>
    <tr><td class="paramname">false</td><td>The operation was completed successfully.  </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="abd0b9d91ab88ee3f1a10495d2884c3b1" name="abd0b9d91ab88ee3f1a10495d2884c3b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd0b9d91ab88ee3f1a10495d2884c3b1">&#9670;&#160;</a></span>osdep_heap_trace_stop()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool osdep_heap_trace_stop </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Stop the heap tracer. </p>
<p><dl class="section user"><dt>Parameters</dt><dd>None. </dd></dl>
 </p><dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>The operation was completed successfully.  </td></tr>
    <tr><td class="paramname">false</td><td>The operation was completed successfully.  </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_38022219427cd2fba679d3084a363551.html">osdep</a></li><li class="navelem"><a class="el" href="heap_8h.html">heap.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
